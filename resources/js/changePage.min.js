function redimensiona() {
    if(pagina == null) { pagina = 0}

    anchoPagina = $('#content').width();
    altoPagina = $('#content').height();
    inicial = -pagina * altoPagina;
    $primera.css({
        marginTop: inicial
    });

    // if ( pagina == (numeroPaginas - 1) ) {
    //     $('.navegacion .topPage').css({display:'block'})
    //     $('.navegacion .downPage').css({display:'none'})
    // }
    // else if ( pagina == 0) {
    //     $('.navegacion .topPage').css({display:'none'})
    //     $('.navegacion .downPage').css({display:'block'})
    // }
    // else {
    //     $('.navegacion .topPage, .navegacion .downPage').css({display:'block'})
    // }
}
function touchStart(e) {
    document.addEventListener("touchmove", touchMove, false);
    document.addEventListener("touchend", touchEnd, false);
//    e.stopPropagation();
    // e.preventDefault();
    originalCoord = e.targetTouches[0].pageY;
    originalCoordX = e.targetTouches[0].pageX;
}
function touchMove(e) {
    e.preventDefault();
    finalCoord = e.targetTouches[0].pageY;
    finalCoordX = e.targetTouches[0].pageX;
    feedback();

    if ( posX < -40 || posX > 40) { touchEnd(); }
    else {
        if ( posY < -10 || posY > 10) { 
            $primera.css({ marginTop: inicial + posY })
        }
    };
};
function feedback() {
    posX = finalCoordX -originalCoordX
    posY = finalCoord - originalCoord
};
function touchEnd(e) {
    document.removeEventListener("touchstart", touchMove, false);
    document.removeEventListener("touchmove", touchMove, false);
    document.removeEventListener("touchend", touchEnd, false);

    if (posY < -100) {
        pagina = pagina + 1
    }
    if (posY > 100) {
        pagina = pagina - 1
    }
    if (pagina < 0) {
        pagina = 0
    }
    if (pagina > numeroPaginas - 1) {
        pagina = numeroPaginas - 1
    }
    inicial = -pagina * altoPagina;
    $primera.animate({
        marginTop: inicial
    }, 400, "easeOutCubic");

    // if ( pagina == (numeroPaginas - 1) ) {
    //     $('.navegacion .topPage').css({display:'block'})
    //     $('.navegacion .downPage').css({display:'none'})
    // }
    // else if ( pagina == 0) {
    //     $('.navegacion .topPage').css({display:'none'})
    //     $('.navegacion .downPage').css({display:'block'})
    // }
    // else {
    //     $('.navegacion .topPage, .navegacion .downPage').css({display:'block'})
    // }

    posY = 0;

    // LI ACTIVO FOOTER
    $('footer nav li').removeClass('actual');
    $('footer nav li:nth-child('+(pagina+1)+')').addClass('actual');
}
var anchoPagina, altoPagina, pagina, inicial, numeroPaginas, section;
inicial = 0;
seccion = null ;

numeroPaginas = $(".page").length;
$primera = $(".page:first-child");
$(document).ready(function () {
    redimensiona()
});
$(window).resize(function () {
    redimensiona()
});
$("#content section").on("touchstart", function (e) {
    document.addEventListener("touchstart", touchStart, false)
});

document.addEventListener('pageshow',  function(e) {
    pagina = e.data.section;

    pagina = parseInt(pagina);
    // LI ACTIVO FOOTER
    $('footer nav li').removeClass('actual');
    $('footer nav li:nth-child('+(pagina+1)+')').addClass('actual');

    redimensiona();
}, false);





// NAVEGACION
// var inicioCrono, actualCrono, pulsado;
// inicioCrono = actualCrono = 0;
// pulsado = false;

// document.addEventListener("touchstart", iniciaCrono, false);
// document.addEventListener("touchend", ocultaNavegacion, false);


// function iniciaCrono(e) {
//     e.preventDefault();

//     pulsado = true;
//     inicioCrono = new Date;
//     hours = inicioCrono.getHours();
//     hours = hours * 60 * 60 * 1000;
//     minutes = inicioCrono.getMinutes();
//     minutes = minutes * 60 * 1000;
//     seconds = inicioCrono.getSeconds();
//     seconds = seconds * 1000; 
//     milliseconds = inicioCrono.getMilliseconds();
//     inicioCrono = milliseconds + seconds + minutes;

//     actualizaCrono();
// };

// function actualizaCrono() {
//     actualCrono = new Date;
//     Ahours = actualCrono.getHours();
//     Ahours = Ahours * 60 * 60 * 1000;
//     Aminutes = actualCrono.getMinutes();
//     Aminutes = Aminutes * 60 * 1000;
//     Aseconds = actualCrono.getSeconds();
//     Aseconds = Aseconds * 1000; 
//     Amilliseconds = actualCrono.getMilliseconds();
//     actualCrono = Amilliseconds + Aseconds + Aminutes;

//     comparaCrono();
// }

// function comparaCrono() {
//     diferencia = actualCrono - inicioCrono;
//     if (diferencia > 500) {
//         if( pulsado == true) {
//             $('.navegacion').css({display:'block'})
//             $('.navegacion').animate({opacity:0.5}, 500, 'linear');
//         }
//     }
//     else {
//         setTimeout(function(){actualizaCrono();},50)
//     }
// }

// function ocultaNavegacion(e) {
//     e.preventDefault();

//     inicioCrono = actualCrono = 0;
//     pulsado = false;

//     $('.navegacion').clearQueue().stop();
//     $('.navegacion').css({opacity:0});
//     $('.navegacion').css({display:'none'})
// }

function cambiaPagina(paginaLanzada) {

    pagina = paginaLanzada;
    inicial = -pagina * altoPagina;

    $primera.animate({
        marginTop: inicial
    }, 400, "easeOutCubic");

    // LI ACTIVO FOOTER
    $('footer nav li').removeClass('actual');
    $('footer nav li:nth-child('+(pagina+1)+')').addClass('actual');

};